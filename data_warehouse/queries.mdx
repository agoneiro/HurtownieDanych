-- 1.1. Czy gracze, którzy korzystają z promocji, spędzają więcej czasu w kasynie?
SELECT
{
    [Measures].[Liczba wizyt],
    [Measures].[SredniCzasTrwaniaWizyt]
}
ON COLUMNS,
NON EMPTY ORDER(
    [Gracz].[Status Czlonkostwa].Children
    [Measures].[SredniCzasTrwaniaWizyt],
    BDESC
)
ON ROWS 
FROM [Casino Data Warehouse]
WHERE ( [Promocja].[Typ Promocji].[All] )

-- 1.2. Czy dłuższe wizyty wiążą się z większą liczbą sesji gier?
TODO

-- 1.3. Jak status członkostwa gracza wpływa na czas wizyty?
SELECT
{
    [Measures].[SredniCzasTrwaniaWizyt]
}
ON COLUMNS,
{
    [Gracz].[Status Czlonkostwa].Children
}
ON ROWS FROM [Casino Data Warehouse]

-- 1.4. Czy gracze, którzy dokonują zakupów w trakcie wizyty, spędzają więcej czasu w
kasynie?
SELECT
{
    [Measures].[SredniCzasTrwaniaWizyt]
}
ON COLUMNS,
{
    [Wizyta].[Czy Zakup].Children
}
ON ROWS FROM [Casino Data Warehouse]


-- 1.5. Jak wiek gracza wpływa na czas wizyty?
SELECT 
{
    [Measures].[SredniCzasTrwaniaWizyt]
}
ON COLUMNS,
{
    [Gracz].[Kategoria Wiekowa].Children
}
ON ROWS FROM [Casino Data Warehouse]

-- 2.1. Jak długo średnio trwa sesja gry, w zależności od typu gry?
SELECT 
{
    [Measures].[SredniCzasTrwaniaSesji]
} 
ON COLUMNS,
{
    [Gra].[Kategoria].Children
}
ON ROWS FROM [Casino Data Warehouse]

-- 2.2. Jakie gry są najczęściej wybierane przez graczy w trakcie jednej wizyty?
SELECT 
{
    [Measures].[Liczba sesji gier]
}
ON COLUMNS,
{
    [Gra].[Nazwa Gry].Children
}
ON ROWS FROM [Casino Data Warehouse]

-- 2.3. Czy obecność wybranych pracowników wpływa na długość sesji gry?
SELECT
{
    [Measures].[SredniCzasTrwaniaSesji],
    [Measures].[Liczba sesji gier]
}
ON COLUMNS,
NON EMPTY TopCount(
    [Pracownik].[Pelne Imie].Children,
    10,
    [Measures].[SredniCzasTrwaniaSesji]
)
ON ROWS FROM [Casino Data Warehouse]

-- 2.4. Czy średnia ilość gier zależy od lokalizacji kasyna?
WITH MEMBER [Measures].[SredniaLiczbaGierNaWizyte] AS
    IIF(
        [Measures].[Liczba wizyt] = 0,
        NULL,
        [Measures].[Liczba sesji gier] / [Measures].[Liczba wizyt]
    )
SELECT
{
    [Measures].[Liczba sesji gier],
    [Measures].[Liczba wizyt],
    [Measures].[SredniaLiczbaGierNaWizyte]
}
ON COLUMNS,
ORDER(
    [Kasyno].[Miasto].Children,
    [Measures].[SredniaLiczbaGierNaWizyte],
    BDESC
)
ON ROWS FROM [Casino Data Warehouse]

-- 2.5. Jak różne typy promocji wpływają na liczbę sesji gier w trakcie wizyty?
WITH MEMBER [Measures].[SredniaLiczbaGierNaWizyte] AS
    IIF(
        [Measures].[Liczba wizyt] = 0,
        NULL,
        [Measures].[Liczba sesji gier] / [Measures].[Liczba wizyt]
    )
SELECT
{
    [Measures].[Liczba sesji gier],
    [Measures].[Liczba wizyt],
    [Measures].[SredniaLiczbaGierNaWizyte]
}
ON COLUMNS,
ORDER(
    [Promocja].[Typ Promocji].Children,
    [Measures].[SredniaLiczbaGierNaWizyte],
    BDESC
)
ON ROWS FROM [Casino Data Warehouse]
